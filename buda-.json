{
  "createdAt": "2025-09-11T20:27:37.749Z",
  "updatedAt": "2025-10-21T20:47:12.000Z",
  "id": "wwr606l1ju9RqW0S",
  "name": "Buda",
  "active": false,
  "isArchived": false,
  "nodes": [
    {
      "parameters": {
        "httpMethod": "POST",
        "path": "buda",
        "responseMode": "responseNode",
        "options": {
          "binaryPropertyName": "file"
        }
      },
      "type": "n8n-nodes-base.webhook",
      "typeVersion": 2.1,
      "position": [
        -496,
        160
      ],
      "id": "8f55709f-2fae-4545-be74-6d74c88041ec",
      "name": "Webhook",
      "webhookId": "ec10fe26-4c2f-4142-82a2-2baa07332952"
    },
    {
      "parameters": {
        "keepOnlySet": true,
        "values": {
          "string": [
            {
              "name": "transcription",
              "value": "={{$json[\"text\"]}}"
            }
          ]
        },
        "options": {}
      },
      "id": "6c5986a9-7662-4bd4-a7b8-bfd3b87dd7b7",
      "name": "Extrair Texto",
      "type": "n8n-nodes-base.set",
      "typeVersion": 2,
      "position": [
        352,
        128
      ]
    },
    {
      "parameters": {
        "resource": "audio",
        "operation": "transcribe",
        "binaryPropertyName": "file0",
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.openAi",
      "typeVersion": 1.8,
      "position": [
        48,
        144
      ],
      "id": "c1bab6a2-1d50-4d84-8396-2345e66cb44d",
      "name": "Transcribe a recording",
      "retryOnFail": true,
      "credentials": {
        "openAiApi": {
          "id": "4fXizCuCrLR4SEIp",
          "name": "OpenAi account"
        }
      },
      "onError": "continueErrorOutput"
    },
    {
      "parameters": {
        "functionCode": "if (item.binary?.file0) {\n  item.binary.file = item.binary.file0;\n  delete item.binary.file0;\n}\n\n// Força o formato aceito pelo OpenAI\nif (item.binary?.file) {\n  item.binary.file.fileName = \"audio.ogg\";   // renomeia\n  item.binary.file.mimeType = \"audio/ogg\";   // força MIME válido\n}\n\nreturn item;"
      },
      "id": "067e8da6-189f-4551-8d8e-c0e94da8fbce",
      "name": "Padronizar binário (file0→file)",
      "type": "n8n-nodes-base.functionItem",
      "typeVersion": 1,
      "position": [
        -192,
        192
      ]
    },
    {
      "parameters": {
        "options": {}
      },
      "id": "aafac2b9-90a5-427e-8d0a-92baaa037caa",
      "name": "Responder ao Webhook (JSON)",
      "type": "n8n-nodes-base.respondToWebhook",
      "typeVersion": 1,
      "position": [
        592,
        128
      ]
    },
    {
      "parameters": {
        "httpMethod": "POST",
        "path": "agente_audio",
        "options": {}
      },
      "type": "n8n-nodes-base.webhook",
      "typeVersion": 2.1,
      "position": [
        -512,
        368
      ],
      "id": "5416196b-51c9-4dec-83e8-9e244eac2e5c",
      "name": "Webhook1",
      "webhookId": "14764769-99a5-494f-a930-ee0935051723"
    },
    {
      "parameters": {},
      "type": "n8n-nodes-base.merge",
      "typeVersion": 3.2,
      "position": [
        528,
        368
      ],
      "id": "7802a79e-1c77-4543-9010-341409ceb6b0",
      "name": "Merge"
    },
    {
      "parameters": {
        "respondWith": "json",
        "responseBody": "{\n  \"error\": \"audio_processing_failed\",\n  \"message\": \"Falha no processamento do áudio\"\n}",
        "options": {
          "responseCode": 422
        }
      },
      "id": "6bac69f7-58e3-4494-abe7-29ea079f3f48",
      "name": "Webhook response on error",
      "type": "n8n-nodes-base.respondToWebhook",
      "typeVersion": 1,
      "position": [
        224,
        256
      ]
    }
  ],
  "connections": {
    "Webhook": {
      "main": [
        [
          {
            "node": "Padronizar binário (file0→file)",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Transcribe a recording": {
      "main": [
        [
          {
            "node": "Extrair Texto",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Webhook response on error",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Padronizar binário (file0→file)": {
      "main": [
        [
          {
            "node": "Transcribe a recording",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Extrair Texto": {
      "main": [
        [
          {
            "node": "Responder ao Webhook (JSON)",
            "type": "main",
            "index": 0
          },
          {
            "node": "Merge",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Webhook1": {
      "main": [
        [
          {
            "node": "Merge",
            "type": "main",
            "index": 1
          }
        ]
      ]
    }
  },
  "settings": {
    "executionOrder": "v1"
  },
  "staticData": null,
  "meta": {
    "templateCredsSetupCompleted": true
  },
  "pinData": {},
  "versionId": "52c17734-d7c9-4dd9-bc4b-48619177874d",
  "triggerCount": 2,
  "shared": [
    {
      "createdAt": "2025-09-11T20:27:37.756Z",
      "updatedAt": "2025-09-11T20:27:37.756Z",
      "role": "workflow:owner",
      "workflowId": "wwr606l1ju9RqW0S",
      "projectId": "TjZRFTZS7ptjaNGj"
    }
  ],
  "tags": []
}